# 02. BLE GATT handshake

## Сервисы и характеристики
* Service UUID: `00000bd1-0000-1000-8000-00805f9b34fb`
* Notify characteristic: `00002021-0000-1000-8000-00805f9b34fb` (handle 0x0023)
* Control/Write characteristic: `00002020-0000-1000-8000-00805f9b34fb` (handle 0x0023 в дампе объединён с notify; в коде разделены)
* CCCD UUID: `00002902-0000-1000-8000-00805f9b34fb`

## Порядок операций
1. Service discovery — запросы `Read By Group Type (0x10)` по UUID 0x2800 в кадрах 12231–12237.
2. Чтение характеристик и дескрипторов: серия `Read Request (0x08)` и `Read Response (0x09)` для 0x2802/0x2803/0x2a00/0x2a01/0x2b2a (кадры 12214–12270).
3. Включение уведомлений — запись CCCD для notify/control (видно по переходу состояния в `HandshakeWriting`).
4. Стартовый write без ответа на handle 0x0023: полезная нагрузка `00 00 06 11 01 00` (кадр 12315).
5. Приём первого уведомления `Handle Value Notification (0x1b)` от того же handle с байтами `00 00 09 10 0a 06 4e 23 ff b1 90 d3 10 46 1a 04 21 91 00 00` (кадр 12402), после чего состояние переходит в READY.

## Payloadы handhsake/аутентификации
* Start: `00 00 06 11 01 00` — минимальный «пробуждающий» пакет.
* Дальнейшие команды на 0x0023 — крупные блоки `00 00 02 10 0a 06 ...` и `00 00 02 10 0a 06 ... 0f` (кадры 12321 и 12325). Они содержат поле `02 01 06` и цепочку байтов, похожую на протокол аутентификации.
* После них приходят парные уведомления `00 00 09 10 0a 06 4e 23 ff b1 90 d3 10 46 1a 04 21 91 00 00` / `...47 1a 04 21 91 00 00` (кадры 12402–12433), показывающие статус/nonce устройства.
